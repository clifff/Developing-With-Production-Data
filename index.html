<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>Data Snapshots</title>

  <meta name="description" content="TODO: THIS">
  <meta name="author" content="Clif Reeder">
  <meta name="viewport" content="width=960">


  <link rel="stylesheet" href="./core/deck.core.css">
  <link rel="stylesheet" href="./extensions/navigation/deck.navigation.css">
  <link rel="stylesheet" href="./extensions/menu/deck.menu.css">
  <link rel="stylesheet" href="./extensions/status/deck.status.css">

  <link rel="stylesheet" href="./themes/style/web-2.0.css">
  <link rel="stylesheet" href="./themes/transition/horizontal-slide.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.5.3/modernizr.min.js"></script>
</head>
<body class="deck-container">
  <section class="slide">
    <h1>Developing With Production Data</h1>
  </section>

  <section class="slide">
    <h2>Problem</h2>
    <p>How do we keep developer/tester data useful?</p>
  </section>

  <section class="slide">
    <h2>Depends. Who are you?</h2>
    <p>Vox Media. We run...
      <ul>
        <li>300+ sports blogs</li>
        <li>21 Regional Sites</li>
        <li>SBNation.com</li>
        <li>The Verge</li>
        <li>One big CMS, with lots of user generated content w/ different styles</li>
      </ul>
    </p>
  </section>

  <section class="slide">
    <h2>Solutions</h2>
    <p>
      <ul>
        <li> 'Right' answer is probably fixtures/written test data.</li>
        <li>I was just saying, we have a really wide variety of data, and users of each site do things a little differently.</li>
        <li>Never as good as real data. Has to constantly be updated. </li>
        <li>Use production data!</li>
      <ul>
    </p>
  </section>

  <section class="slide">
    <h2>Complications</h2>
    <p>
      <ul>
        <li>Production database is ~75 GB, so that's not really an option.</li>
        <li>How do we make images hosted on S3 work?</li>
      </ul>
    </p>
  </section>

  <section class="slide">
    <h2>General Process</h2>
    <p>
      <ul>
        <li>Figure out what your 'big models' are</li>
        <li>Connect AR to DB slave</li>
        <li>For every table, mysqldump to file. A subset, if its a big table</li>
        <li>Import that dump into a temporary DB</li>
          <ul>
            <li>Why? Because we need to anonymize/delete things.</li>
          </ul>
        <li>For every big model</li>
        <ul>
          <li>For every table</li>
          <ul>
            <li>If foreign keys to big table, DELETE things that are missing</li>
          </ul>
          <li>end</li>
        </ul>
        <li>end</li>
      </ul>
    </p>
  </section>

  <section class="slide">
    <h2> Process conintuned...</h2>
    <p>
      <ul>
        <li>Anonymize user data</li>
        <li>Change all passworsd to known crypted/salt</li>
        <li>Wipe all stored ip adresses</li>
        <li>Wipe all stored analytics related data</li>
        <li>Anonymize all emails, etc, etc</li>
        <li>Dump that temporary DB, gzip, upload to S3</li>
    </p>
  </section>

  <section class="slide">
    <h2>How is it used?</h2>
    <p>
      <ul>
        <li>Rake task to download/import</li>
        <li>For sandboxes, mount to EBS volume, clone/attach as needed</li>
     </ul>
    </p>
  </section>

  <!-- Grab CDN jQuery, with a protocol relative URL; fall back to local if offline -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="./jquery-1.7.min.js"><\/script>')</script>

  <script src="./core/deck.core.js"></script>
  <script src="./extensions/navigation/deck.navigation.js"></script>
  <script src="./extensions/menu/deck.menu.js"></script>
  <script src="./extensions/status/deck.status.js"></script>

  <script>
    $(function() {
      $.deck('.slide');
    });
  </script>
</body>
</html>
